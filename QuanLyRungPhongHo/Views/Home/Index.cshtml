@model QuanLyRungPhongHo.Models.HomeViewModel
@{
    ViewData["Title"] = "Trang Chủ - Quản Lý Rừng Phòng Hộ";
}


<!-- Banner Chào Mừng -->
<div class="welcome-banner mb-4 p-4 bg-success bg-gradient text-white rounded shadow">
    <div class="d-flex align-items-center justify-content-between">
        <div>
            <h2 class="mb-1">
                <i class="bi bi-house-heart"></i>
                Xin chào, <strong>@Model.HoTen</strong>
            </h2>
            <p class="mb-0">
                <i class="bi bi-briefcase"></i> @Model.ChucVu |
                <i class="bi bi-shield-check"></i> @Model.Quyen |
                <i class="bi bi-calendar-check"></i> @DateTime.Now.ToString("dd/MM/yyyy HH:mm")
            </p>
        </div>
        <div class="text-end">
            <i class="bi bi-tree" style="font-size: 4rem; opacity: 0.3;"></i>
        </div>
    </div>
</div>

<!-- Tổng Quan -->
<h4 class="mb-3"><i class="bi bi-bar-chart-fill"></i> Tổng Quan Nhanh</h4>
<div class="row g-4 mb-4">
    <!-- Tổng Diện Tích -->
    <div class="col-xl-3 col-lg-6 col-md-6">
        <div class="card border-0 shadow-sm h-100">
            <div class="card-body text-center py-4">
                <div class="mb-3">
                    <i class="bi bi-geo-alt-fill text-success" style="font-size: 3rem;"></i>
                </div>
                <h2 class="mb-0 fw-bold text-success">@Model.TongDienTich.ToString("N2")</h2>
                <p class="text-muted mb-0 mt-2">Tổng Diện Tích (ha)</p>
            </div>
        </div>
    </div>

    <!-- Số Lô Rừng -->
    <div class="col-xl-3 col-lg-6 col-md-6">
        <div class="card border-0 shadow-sm h-100">
            <div class="card-body text-center py-4">
                <div class="mb-3">
                    <i class="bi bi-grid-3x3-gap-fill text-primary" style="font-size: 3rem;"></i>
                </div>
                <h2 class="mb-0 fw-bold text-primary">@Model.TongSoLoRung</h2>
                <p class="text-muted mb-0 mt-2">Số Lô Rừng</p>
            </div>
        </div>
    </div>

    <!-- Số Nhân Sự -->
    <div class="col-xl-3 col-lg-6 col-md-6">
        <div class="card border-0 shadow-sm h-100">
            <div class="card-body text-center py-4">
                <div class="mb-3">
                    <i class="bi bi-people-fill text-info" style="font-size: 3rem;"></i>
                </div>
                <h2 class="mb-0 fw-bold text-info">@Model.TongSoNhanSu</h2>
                <p class="text-muted mb-0 mt-2">Nhân Sự Bảo Vệ</p>
            </div>
        </div>
    </div>

    <!-- Cảnh Báo 7 Ngày -->
    <div class="col-xl-3 col-lg-6 col-md-6">
        <div class="card border-danger shadow h-100" style="border-width: 3px !important;">
            <div class="card-body text-center py-4">
                <div class="mb-3">
                    <i class="bi bi-exclamation-triangle-fill text-danger" style="font-size: 3rem;"></i>
                </div>
                <h2 class="mb-0 fw-bold text-danger">@Model.SoCanhBao7Ngay</h2>
                <p class="text-muted mb-0 mt-2">Cảnh Báo (7 ngày)</p>
            </div>
        </div>
    </div>
</div>

<!-- CẢNH BÁO KHẨN CẤP -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card border-0 shadow-sm">
            <div class="card-header bg-danger text-white py-3">
                <h5 class="mb-0">
                    <i class="bi bi-bell-fill"></i>
                    Cảnh Báo Khẩn Cấp
                    <span class="badge bg-white text-danger ms-2">@Model.DanhSachCanhBao.Count</span>
                </h5>
            </div>
            <div class="card-body p-0">
                @if (Model.DanhSachCanhBao.Any())
                {
                    <div class="table-responsive">
                        <table class="table table-hover mb-0">
                            <thead class="table-light">
                                <tr>
                                    <th width="5%"><i class="bi bi-flag-fill"></i></th>
                                    <th width="15%">Thời Gian</th>
                                    <th width="15%">Loại Sự Việc</th>
                                    <th width="30%">Nội Dung</th>
                                    <th width="15%">Vị Trí</th>
                                    <th width="10%">Xã</th>
                                    <th width="10%">Người Ghi</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.DanhSachCanhBao)
                                {
                                    <tr>
                                        <td class="text-center">
                                            <i class="bi bi-circle-fill text-@item.MucDoClass"></i>
                                        </td>
                                        <td>
                                            <small>@item.NgayGhi.ToString("dd/MM/yyyy HH:mm")</small>
                                        </td>
                                        <td>
                                            <span class="badge bg-@item.MucDoClass">@item.LoaiSuViec</span>
                                        </td>
                                        <td>
                                            <small>@(item.NoiDung?.Length > 50 ? item.NoiDung.Substring(0, 50) + "..." : item.NoiDung)</small>
                                        </td>
                                        <td><small>@item.ViTri</small></td>
                                        <td><small>@item.TenXa</small></td>
                                        <td><small>@item.NguoiGhiNhan</small></td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                }
                else
                {
                    <div class="p-4 text-center text-muted">
                        <i class="bi bi-check-circle" style="font-size: 3rem;"></i>
                        <p class="mt-2">Không có cảnh báo khẩn cấp</p>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

<!-- CÔNG VIỆC CỦA TÔI -->
@if (Model.MaNV.HasValue)
{
    <div class="row">
        <div class="col-lg-4 mb-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-primary text-white py-3">
                    <h5 class="mb-0">
                        <i class="bi bi-clipboard-check"></i>
                        Công Việc Của Tôi
                    </h5>
                </div>
                <div class="card-body">
                    <div class="mb-3 pb-3 border-bottom">
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="text-muted">Lô rừng phụ trách:</span>
                            <strong class="text-primary fs-4">@Model.SoLoRungPhuTrach</strong>
                        </div>
                    </div>
                    <div class="mb-3 pb-3 border-bottom">
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="text-muted">Diện tích:</span>
                            <strong class="text-success fs-5">@Model.DienTichPhuTrach.ToString("N2") ha</strong>
                        </div>
                    </div>
                    <div>
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="text-muted">Nhật ký đã ghi:</span>
                            <strong class="text-info fs-5">@Model.SoNhatKyDaGhi</strong>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- HOẠT ĐỘNG GẦN ĐÂY CỦA TÔI -->
        <div class="col-lg-8 mb-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-info text-white py-3">
                    <h5 class="mb-0">
                        <i class="bi bi-clock-history"></i>
                        Hoạt Động Gần Đây Của Tôi
                    </h5>
                </div>
                <div class="card-body">
                    @if (Model.NhatKyGanDay.Any())
                    {
                        <div class="timeline">
                            @foreach (var nk in Model.NhatKyGanDay)
                            {
                                <div class="timeline-item mb-3">
                                    <div class="d-flex">
                                        <div class="timeline-marker me-3">
                                            <i class="bi bi-circle-fill text-info"></i>
                                        </div>
                                        <div class="flex-grow-1">
                                            <div class="d-flex justify-content-between">
                                                <strong>@nk.LoaiSuViec</strong>
                                                <small class="text-muted">@nk.NgayGhi.ToString("dd/MM/yyyy HH:mm")</small>
                                            </div>
                                            <p class="mb-1 text-muted small">@nk.NoiDung</p>
                                            <small class="text-info"><i class="bi bi-geo-alt"></i> @nk.ViTri</small>
                                        </div>
                                    </div>
                                </div>
                            }
                        </div>
                    }
                    else
                    {
                        <div class="text-center text-muted py-4">
                            <i class="bi bi-journal-x" style="font-size: 3rem;"></i>
                            <p class="mt-2">Chưa có hoạt động nào</p>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
}

<style>
    .welcome-banner {
        background: linear-gradient(135deg, #2d7a4e 0%, #4caf50 100%);
    }

    .card {
        transition: transform 0.2s, box-shadow 0.2s;
    }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.15) !important;
        }

    .card-body h2 {
        font-size: 2.5rem;
    }

    .table-hover tbody tr:hover {
        background-color: #f8f9fa;
        cursor: pointer;
    }

    .timeline-item {
        position: relative;
        padding-left: 0;
    }

    .timeline-marker {
        font-size: 0.8rem;
    }
</style>


